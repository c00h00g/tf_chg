# -*- coding:utf-8 -*-
import sys
import tensorflow as tf
import os
os.environ["CUDA_VISIBLE_DEVICES"] = "3"

#(3, 3, 3)
a = tf.constant([[[1, 1, 1], [3, 4, 5], [5, 6, 7]], [[2, 2, 2], [4, 4, 4], [6, 6, 6]], [[3, 3, 3], [7, 8, 9], [9, 10, 11]]], dtype = tf.float32)
print(a.shape)

#在最后一个维度softmax
b = tf.nn.softmax(a, axis = -1)
print(b)

#[[[0.33333334 0.33333334 0.33333334]
#  [0.09003057 0.24472848 0.66524094]
#  [0.09003057 0.24472848 0.66524094]]
#
#  [[0.33333334 0.33333334 0.33333334]
#   [0.33333334 0.33333334 0.33333334]
#   [0.33333334 0.33333334 0.33333334]]
#
#  [[0.33333334 0.33333334 0.33333334]
#   [0.09003057 0.24472848 0.66524094]
#   [0.09003057 0.24472848 0.66524094]]]
with tf.Session() as sess:
    print(sess.run(b))
